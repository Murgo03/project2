<html>
<head>
       <title>Giphy Search</title>
    <link rel="stylesheet" href="styles/stylesheet.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
 
</head>
<body>
    <div>
        <div class="container text-center">
    <h1>GIPHY Search</h1>

       <form>
      <input class= "search-box" type="search" id="searchInput" placeholder="Enter search"/>
      <div>
        <button type="button" onClick="handleClickSingle()">Single</button> 
        <button type="button" onClick="handleClickArray()">Array</button> 
      </div>
    </form>

    <div id="outputArea"></div>
    <div class="pagination" id="paginationControls"></div> 
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
const API_KEY = "tC6aP4eKWmkEW4i7EShIF6K1oFTDlq9Z";
const PAGE_SIZE = 10;
let offset = 0;
let currentSearch = "";


function handleClickSingle() {
  console.log("handleClickSingle called");   
  currentSearch = document.getElementById("searchInput").value.trim();
  offset = 0;
  const elementOutputArea = document.getElementById("outputArea");
  let url = `https://api.giphy.com/v1/gifs/search?q=${currentSearch}&api_key=${API_KEY}&limit=10&offset=0`;

  fetch(url)
    .then((response) => response.json())
    .then((json) => {
      const data = json.data;
      if (data.length > 0) {
        const gifUrl = data[0].images.fixed_height.url;
        elementOutputArea.innerHTML = `<img src="${gifUrl}" alt="GIF result">`;
      } else {
        elementOutputArea.innerHTML = "<p>No results found.</p>";
      }
      document.getElementById("paginationControls").innerHTML = ""; 
    });
}


function handleClickArray() {
  console.log("handleClickArray called");   
  currentSearch = document.getElementById("searchInput").value.trim();
  offset = 0;
  fetchAndDisplayGifs();
}

function fetchAndDisplayGifs() {
  const elementOutputArea = document.getElementById("outputArea");
  const paginationControls = document.getElementById("paginationControls");

  let url = `https://api.giphy.com/v1/gifs/search?q=${currentSearch}&api_key=${API_KEY}&limit=${PAGE_SIZE}&offset=${offset}`;
  console.log('url=' + url);

  fetch(url)
    .then((response) => response.json())
    .then((json) => {
      console.log(json.pagination);

      let s = "";
      for (let gif of json.data) {
        let imgUrl = gif.images.fixed_height.url;
        s += `<img class="gif" src="${imgUrl}" alt="${gif.title}" style="margin:5px;">`;
      }
      elementOutputArea.innerHTML = s || "<p>No results found.</p>";

      
      paginationControls.innerHTML = `
        <button onclick="prevPage()" ${offset === 0 ? "disabled" : ""}>Previous</button>
        <button onclick="nextPage()">Next</button>
      `;
    });
}

function nextPage() {
  offset += PAGE_SIZE;
  fetchAndDisplayGifs();
}

function prevPage() {
  if (offset >= PAGE_SIZE) {
    offset -= PAGE_SIZE;
  } else {
    offset = 0;
  }
  fetchAndDisplayGifs();
}
</script>

</body>

</html>